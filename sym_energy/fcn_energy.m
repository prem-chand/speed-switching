function [ME,KE,PE] = fcn_energy(q)

  model_params;

  ME(1,1)=(4704*cos(q(1) + q(3) + q(5)))/625 - (73696*cos(q(1) + q(2) + q(4)))/625 - (131957*...
         cos(q(1) + q(2)))/1250 + (24843*cos(q(1) + q(3)))/1250 + (3528*cos(q(1)))/125 - (507*dq(1)^2*...
         cos(q(2) - q(3)))/625 + (47259*dq(1)*dq(2))/5000 + (7243*dq(1)*dq(3))/5000 + (15281*dq(1)*dq(4))/3125 + (1201*dq(1)*...
         dq(5))/3125 + (15281*dq(2)*dq(4))/3125 + (1201*dq(3)*dq(5))/3125 - (192*dq(1)^2*cos(q(2) - q(3) +...
          q(4) - q(5)))/625 - (507*dq(1)^2*cos(q(2) - q(3) + q(4)))/625 + (4038*dq(1)^2)/625 + (47259*dq(2)^2)/10000 + (7243*...
         dq(3)^2)/10000 + (15281*dq(4)^2)/6250 + (1201*dq(5)^2)/6250 - (144*dq(1)^2*cos(q(2) + q(4)))/125 - (144*dq(1)^2*...
         cos(q(2)))/125 + (2693*dq(1)^2*cos(q(4)))/625 + (2693*dq(2)^2*cos(q(4)))/625 + (192*dq(1)^2*cos(q(5)))/625 + (192*...
         dq(3)^2*cos(q(5)))/625 - (192*dq(1)^2*cos(q(2) - q(3) - q(5)))/625 - (507*dq(1)*dq(2)*...
         cos(q(2) - q(3)))/625 - (507*dq(1)*dq(3)*cos(q(2) - q(3)))/625 - (507*dq(2)*dq(3)*cos(q(2) - q(3)))/625 - (192*dq(1)*dq(2)*...
         cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(1)*dq(3)*cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(1)*dq(4)*...
         cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(2)*dq(3)*cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(1)*dq(5)*...
         cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(2)*dq(5)*cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(3)*dq(4)*...
         cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(4)*dq(5)*cos(q(2) - q(3) + q(4) - q(5)))/625 - (507*dq(1)*dq(2)*...
         cos(q(2) - q(3) + q(4)))/625 - (507*dq(1)*dq(3)*cos(q(2) - q(3) + q(4)))/625 - (507*dq(1)*dq(4)*cos(q(2) - q(3) +...
          q(4)))/625 - (507*dq(2)*dq(3)*cos(q(2) - q(3) + q(4)))/625 - (507*dq(3)*dq(4)*cos(q(2) - q(3) + q(4)))/625 - (144*...
         dq(1)*dq(2)*cos(q(2) + q(4)))/125 - (144*dq(1)*dq(4)*cos(q(2) + q(4)))/125 - (144*dq(1)*dq(2)*...
         cos(q(2)))/125 + (5386*dq(1)*dq(2)*cos(q(4)))/625 + (2693*dq(1)*dq(4)*cos(q(4)))/625 + (2693*dq(2)*dq(4)*...
         cos(q(4)))/625 + (384*dq(1)*dq(3)*cos(q(5)))/625 + (192*dq(1)*dq(5)*cos(q(5)))/625 + (192*dq(3)*dq(5)*...
         cos(q(5)))/625 - (192*dq(1)*dq(2)*cos(q(2) - q(3) - q(5)))/625 - (192*dq(1)*dq(3)*cos(q(2) - q(3) - q(5)))/625 - (192*...
         dq(2)*dq(3)*cos(q(2) - q(3) - q(5)))/625 - (192*dq(1)*dq(5)*cos(q(2) - q(3) - q(5)))/625 - (192*dq(2)*...
         dq(5)*cos(q(2) - q(3) - q(5)))/625;

   KE(1,1)=(47259*dq(1)*dq(2))/5000 - (507*dq(1)^2*cos(q(2) - q(3)))/625 + (7243*dq(1)*dq(3))/5000 +...
          (15281*dq(1)*dq(4))/3125 + (1201*dq(1)*dq(5))/3125 + (15281*dq(2)*dq(4))/3125 + (1201*dq(3)*...
         dq(5))/3125 - (192*dq(1)^2*cos(q(2) - q(3) + q(4) - q(5)))/625 - (507*dq(1)^2*cos(q(2) - q(3) + q(4)))/625 + (4038*...
         dq(1)^2)/625 + (47259*dq(2)^2)/10000 + (7243*dq(3)^2)/10000 + (15281*dq(4)^2)/6250 + (1201*dq(5)^2)/6250 - (144*...
         dq(1)^2*cos(q(2) + q(4)))/125 - (144*dq(1)^2*cos(q(2)))/125 + (2693*dq(1)^2*cos(q(4)))/625 + (2693*dq(2)^2*...
         cos(q(4)))/625 + (192*dq(1)^2*cos(q(5)))/625 + (192*dq(3)^2*cos(q(5)))/625 - (192*dq(1)^2*...
         cos(q(2) - q(3) - q(5)))/625 - (507*dq(1)*dq(2)*cos(q(2) - q(3)))/625 - (507*dq(1)*dq(3)*cos(q(2) - q(3)))/625 - (507*dq(2)*dq(3)*...
         cos(q(2) - q(3)))/625 - (192*dq(1)*dq(2)*cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(1)*dq(3)*cos(q(2) - q(3) +...
          q(4) - q(5)))/625 - (192*dq(1)*dq(4)*cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(2)*dq(3)*cos(q(2) - q(3) +...
          q(4) - q(5)))/625 - (192*dq(1)*dq(5)*cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(2)*dq(5)*cos(q(2) - q(3) +...
          q(4) - q(5)))/625 - (192*dq(3)*dq(4)*cos(q(2) - q(3) + q(4) - q(5)))/625 - (192*dq(4)*dq(5)*cos(q(2) - q(3) +...
          q(4) - q(5)))/625 - (507*dq(1)*dq(2)*cos(q(2) - q(3) + q(4)))/625 - (507*dq(1)*dq(3)*cos(q(2) - q(3) + q(4)))/625 - (507*...
         dq(1)*dq(4)*cos(q(2) - q(3) + q(4)))/625 - (507*dq(2)*dq(3)*cos(q(2) - q(3) + q(4)))/625 - (507*dq(3)*...
         dq(4)*cos(q(2) - q(3) + q(4)))/625 - (144*dq(1)*dq(2)*cos(q(2) + q(4)))/125 - (144*dq(1)*dq(4)*cos(q(2) +...
          q(4)))/125 - (144*dq(1)*dq(2)*cos(q(2)))/125 + (5386*dq(1)*dq(2)*cos(q(4)))/625 + (2693*dq(1)*dq(4)*cos(q(4)))/625 +...
          (2693*dq(2)*dq(4)*cos(q(4)))/625 + (384*dq(1)*dq(3)*cos(q(5)))/625 + (192*dq(1)*dq(5)*cos(q(5)))/625 +...
          (192*dq(3)*dq(5)*cos(q(5)))/625 - (192*dq(1)*dq(2)*cos(q(2) - q(3) - q(5)))/625 - (192*dq(1)*dq(3)*...
         cos(q(2) - q(3) - q(5)))/625 - (192*dq(2)*dq(3)*cos(q(2) - q(3) - q(5)))/625 - (192*dq(1)*dq(5)*cos(q(2) - q(3) - q(5)))/625 - (192*...
         dq(2)*dq(5)*cos(q(2) - q(3) - q(5)))/625;

   PE(1,1)=(4704*cos(q(1) + q(3) + q(5)))/625 - (73696*cos(q(1) + q(2) + q(4)))/625 - (131957*...
         cos(q(1) + q(2)))/1250 + (24843*cos(q(1) + q(3)))/1250 + (3528*cos(q(1)))/125;

 